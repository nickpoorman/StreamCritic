
<!-- saved from url=(0057)http://craftymind.com/factory/html5video/CanvasVideo.html -->
<html><body><div class="webkit-line-gutter-backdrop broke-endless-pages"></div><table><tbody><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-doctype"><span>&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "<a class="smarterwiki-linkify" href="http://www.w3.org/TR/html4/loose.dtd">http://www.w3.org/TR/html4/loose.dtd</a>"&gt;</span></span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;html&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;head&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;title&gt;</span>HTML5 Video Destruction&lt;/title&gt;<span class="webkit-html-tag"></span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;meta <span class="webkit-html-attribute-name">http-equiv</span>="<span class="webkit-html-attribute-value">content-type</span>" <span class="webkit-html-attribute-name">content</span>="<span class="webkit-html-attribute-value">text/html; charset=UTF-8</span>"&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">type</span>="<span class="webkit-html-attribute-value">text/javascript</span>"&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var video;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var copy;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var copycanvas;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var draw;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var TILE_WIDTH = 32;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var TILE_HEIGHT = 24;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var TILE_CENTER_WIDTH = 16;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var TILE_CENTER_HEIGHT = 12;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var SOURCERECT = {x:0, y:0, width:0, height:0};</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var PAINTRECT = {x:0, y:0, width:1000, height:600};</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">function init(){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	video = document.getElementById('sourcevid');</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	copycanvas = document.getElementById('sourcecopy');</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	copy = copycanvas.getContext('2d');</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var outputcanvas = document.getElementById('output');</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	draw = outputcanvas.getContext('2d');</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	setInterval("processFrame()", 33);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">function createTiles(){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var offsetX = TILE_CENTER_WIDTH+(PAINTRECT.width-SOURCERECT.width)/2;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var offsetY = TILE_CENTER_HEIGHT+(PAINTRECT.height-SOURCERECT.height)/2;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var y=0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	while(y &lt; SOURCERECT.height){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		var x=0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		while(x &lt; SOURCERECT.width){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			var tile = new Tile();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.videoX = x;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.videoY = y;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.originX = offsetX+x;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.originY = offsetY+y;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.currentX = tile.originX;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.currentY = tile.originY;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tiles.push(tile);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			x+=TILE_WIDTH;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		y+=TILE_HEIGHT;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var RAD = Math.PI/180;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var randomJump = false;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var tiles = [];</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var debug = false;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">function processFrame(){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	if(!isNaN(video.duration)){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		if(SOURCERECT.width == 0){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			SOURCERECT = {x:0,y:0,width:video.videoWidth,height:video.videoHeight};</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			createTiles();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		//this is to keep my sanity while developing</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		if(randomJump){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			randomJump = false;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			video.currentTime = Math.random()*video.duration;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		//loop</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		if(video.currentTime == video.duration){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			video.currentTime = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var debugStr = "";</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	//copy tiles</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	copy.drawImage(video, 0, 0);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	draw.clearRect(PAINTRECT.x, PAINTRECT.y,PAINTRECT.width,PAINTRECT.height);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	for(var i=0; i&lt;tiles.length; i++){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		var tile = tiles[i];</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		if(tile.force &gt; 0.0001){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			//expand</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.moveX *= tile.force;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.moveY *= tile.force;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.moveRotation *= tile.force;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.currentX += tile.moveX;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.currentY += tile.moveY;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.rotation += tile.moveRotation;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.rotation %= 360;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.force *= 0.9;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			if(tile.currentX &lt;= 0 || tile.currentX &gt;= PAINTRECT.width){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				tile.moveX *= -1;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			if(tile.currentY &lt;= 0 || tile.currentY &gt;= PAINTRECT.height){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				tile.moveY *= -1;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		}else if(tile.rotation != 0 || tile.currentX != tile.originX || tile.currentY != tile.originY){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			//contract</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			var diffx = (tile.originX-tile.currentX)*0.2;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			var diffy = (tile.originY-tile.currentY)*0.2;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			var diffRot = (0-tile.rotation)*0.2;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			if(Math.abs(diffx) &lt; 0.5){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				tile.currentX = tile.originX;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}else{</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				tile.currentX += diffx;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			if(Math.abs(diffy) &lt; 0.5){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				tile.currentY = tile.originY;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}else{</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				tile.currentY += diffy;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			if(Math.abs(diffRot) &lt; 0.5){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				tile.rotation = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}else{</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">				tile.rotation += diffRot;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		}else{</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.force = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		draw.save();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		draw.translate(tile.currentX, tile.currentY);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		draw.rotate(tile.rotation*RAD);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		draw.drawImage(copycanvas, tile.videoX, tile.videoY, TILE_WIDTH, TILE_HEIGHT, -TILE_CENTER_WIDTH, -TILE_CENTER_HEIGHT, TILE_WIDTH, TILE_HEIGHT);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		draw.restore();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	if(debug){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		debug = false;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		document.getElementById('trace').innerHTML = debugStr;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">function explode(x, y){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	for(var i=0; i&lt;tiles.length; i++){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		var tile = tiles[i];</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		var xdiff = tile.currentX-x;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		var ydiff = tile.currentY-y;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		var dist = Math.sqrt(xdiff*xdiff + ydiff*ydiff);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		var randRange = 220+(Math.random()*30);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		var range = randRange-dist;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		var force = 3*(range/randRange);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		if(force &gt; tile.force){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.force = force;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			var radians = Math.atan2(ydiff, xdiff);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.moveX = Math.cos(radians);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.moveY = Math.sin(radians);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			tile.moveRotation = 0.5-Math.random();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	tiles.sort(zindexSort);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	processFrame();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">function zindexSort(a, b){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	return (a.force-b.force);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">function dropBomb(evt, obj){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var posx = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var posy = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var e = evt || window.event;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	if (e.pageX || e.pageY){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		posx = e.pageX;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		posy = e.pageY;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	}else if (e.clientX || e.clientY) {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		posx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		posy = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var canvasX = posx-obj.offsetLeft;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var canvasY = posy-obj.offsetTop;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	explode(canvasX, canvasY);</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">function Tile(){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	this.originX = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	this.originY = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	this.currentX = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	this.currentY = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	this.rotation = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	this.force = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	this.z = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	this.moveX= 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	this.moveY= 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	this.moveRotation = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	this.videoX = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	this.videoY = 0;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">/*</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	getPixel</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	return pixel object {r,g,b,a}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">*/</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">function getPixel(imageData, x, y){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var data = imageData.data;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var pos = (x + y * imageData.width) * 4;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	return {r:data[pos], g:data[pos+1], b:data[pos+2], a:data[pos+3]}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">/*</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	setPixel</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	set pixel object {r,g,b,a}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">*/</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">function setPixel(imageData, x, y, pixel){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var data = imageData.data;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var pos = (x + y * imageData.width) * 4;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	data[pos] = pixel.r;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	data[pos+1] = pixel.g;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	data[pos+2] = pixel.b;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	data[pos+3] = pixel.a;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">/*</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	copyPixel</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	faster then using getPixel/setPixel combo</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">*/</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">function copyPixel(sImageData, sx, sy, dImageData, dx, dy){</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var spos = (sx + sy * sImageData.width) * 4;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	var dpos = (dx + dy * dImageData.width) * 4;</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	dImageData.data[dpos] = sImageData.data[spos];     //R</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	dImageData.data[dpos+1] = sImageData.data[spos+1]; //G</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	dImageData.data[dpos+2] = sImageData.data[spos+2]; //B</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	dImageData.data[dpos+3] = sImageData.data[spos+3]; //A</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">}</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">&lt;/script&gt;<span class="webkit-html-tag"></span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/head&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;body <span class="webkit-html-attribute-name">onload</span>="<span class="webkit-html-attribute-value">init()</span>" <span class="webkit-html-attribute-name">style</span>="<span class="webkit-html-attribute-value">margin:0px;</span>"&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	<span class="webkit-html-tag">&lt;div&gt;</span><span class="webkit-html-tag">&lt;br/&gt;</span><span class="webkit-html-tag">&lt;center&gt;</span>Block based destruction of HTML5 video, best viewed in webkit based browsers. <span class="webkit-html-tag">&lt;a <span class="webkit-html-attribute-name">href</span>="<a class="webkit-html-attribute-value webkit-html-external-link" target="_blank" href="http://www.craftymind.com/2010/04/20/blowing-up-html5-video-and-mapping-it-into-3d-space">http://www.craftymind.com/2010/04/20/blowing-up-html5-video-and-mapping-it-into-3d-space</a>"&gt;</span>Return to Craftymind Article<span class="webkit-html-tag">&lt;/a&gt;</span><span class="webkit-html-tag">&lt;br/&gt;</span>Due to popular request, the ogg video is now 640 x 360, don't hold me responsible for crashing your browser ;)<span class="webkit-html-tag">&lt;/center&gt;</span><span class="webkit-html-tag">&lt;br/&gt;</span><span class="webkit-html-tag">&lt;/div&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	<span class="webkit-html-tag">&lt;div <span class="webkit-html-attribute-name">style</span>="<span class="webkit-html-attribute-value">display:none</span>"&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;video <span class="webkit-html-attribute-name">id</span>="<span class="webkit-html-attribute-value">sourcevid</span>" <span class="webkit-html-attribute-name">autoplay</span>="<span class="webkit-html-attribute-value">true</span>" <span class="webkit-html-attribute-name">loop</span>="<span class="webkit-html-attribute-value">true</span>"&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			<span class="webkit-html-tag">&lt;source <span class="webkit-html-attribute-name">src</span>="<a class="webkit-html-attribute-value webkit-html-resource-link" target="_blank" href="http://craftymind.com/factory/html5video/BigBuckBunny_640x360.mp4">BigBuckBunny_640x360.mp4</a>" <span class="webkit-html-attribute-name">type</span>="<span class="webkit-html-attribute-value">video/mp4</span>"/&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">			<span class="webkit-html-tag">&lt;source <span class="webkit-html-attribute-name">src</span>="<a class="webkit-html-attribute-value webkit-html-resource-link" target="_blank" href="http://craftymind.com/factory/html5video/BigBuckBunny_640x360.ogv">BigBuckBunny_640x360.ogv</a>" <span class="webkit-html-attribute-name">type</span>="<span class="webkit-html-attribute-value">video/ogg</span>"/&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;/video&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;canvas <span class="webkit-html-attribute-name">id</span>="<span class="webkit-html-attribute-value">sourcecopy</span>" <span class="webkit-html-attribute-name">width</span>="<span class="webkit-html-attribute-value">640</span>" <span class="webkit-html-attribute-name">height</span>="<span class="webkit-html-attribute-value">360</span>"&gt;</span><span class="webkit-html-tag">&lt;/canvas&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	<span class="webkit-html-tag">&lt;/div&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	<span class="webkit-html-tag">&lt;div&gt;</span><span class="webkit-html-tag">&lt;center&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;div <span class="webkit-html-attribute-name">style</span>="<span class="webkit-html-attribute-value">z-index:1;position:relative;text-align:center;font-size:16px;font-weight:bold;width:1000px;top:60px;</span>"&gt;</span>Click video to blow it up!<span class="webkit-html-tag">&lt;/div&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">		<span class="webkit-html-tag">&lt;canvas <span class="webkit-html-attribute-name">id</span>="<span class="webkit-html-attribute-value">output</span>" <span class="webkit-html-attribute-name">width</span>="<span class="webkit-html-attribute-value">1000</span>" <span class="webkit-html-attribute-name">height</span>="<span class="webkit-html-attribute-value">600</span>" <span class="webkit-html-attribute-name">onmousedown</span>="<span class="webkit-html-attribute-value">dropBomb(event, this)</span>" <span class="webkit-html-attribute-name">style</span>="<span class="webkit-html-attribute-value">border: solid 5px #666666</span>"&gt;</span><span class="webkit-html-tag">&lt;/canvas&gt;</span><span class="webkit-html-tag">&lt;br/&gt;</span>You may need to reload the page if video isn't streaming properly. Video courtesy of <span class="webkit-html-tag">&lt;a <span class="webkit-html-attribute-name">href</span>="<a class="webkit-html-attribute-value webkit-html-external-link" target="_blank" href="http://www.bigbuckbunny.org/">http://www.bigbuckbunny.org/</a>"&gt;</span>Big Buck Bunny<span class="webkit-html-tag">&lt;/a&gt;</span><span class="webkit-html-tag">&lt;/center&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;br/&gt;</span><span class="webkit-html-tag">&lt;center&gt;</span><span class="webkit-html-tag">&lt;a <span class="webkit-html-attribute-name">href</span>="<a class="webkit-html-attribute-value webkit-html-external-link" target="_blank" href="http://web.me.com/ellestevenson/music/Digistore.html">http://web.me.com/ellestevenson/music/Digistore.html</a>"&gt;</span>You should listen to this new artist, seriously<span class="webkit-html-tag">&lt;/a&gt;</span><span class="webkit-html-tag">&lt;/center&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">	<span class="webkit-html-tag">&lt;/div&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">type</span>="<span class="webkit-html-attribute-value">text/javascript</span>"&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span>var gaJsHost = (("https:" == document.location.protocol) ? "<a class="smarterwiki-linkify" href="https://ssl/">https://ssl</a>." : "<a class="smarterwiki-linkify" href="http://www/">http://www</a>.");</span></td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">&lt;/script&gt;<span class="webkit-html-tag"></span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;script <span class="webkit-html-attribute-name">type</span>="<span class="webkit-html-attribute-value">text/javascript</span>"&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">try {</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">var pageTracker = _gat._getTracker("UA-15981974-1");</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">pageTracker._trackPageview();</td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content">} catch(err) {}&lt;/script&gt;<span class="webkit-html-tag"></span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/body&gt;</span> </td></tr><tr><td class="webkit-line-number"></td><td class="webkit-line-content"><span class="webkit-html-tag">&lt;/html&gt;</span></td></tr></tbody></table></body></html>